---
title: "Ejercicio I de Modelos Lineales"
author:
  - name: "Mtro. Santiago Ríos"
    email: santiagoboo99@gmail.com
    affiliation: 
      - name: Cursos Orca
        city: CDMX
        url: orcaasesina.com
format: 
    live-html:
        # highlightStyle: github
        # highlightLines: true
        theme: lux
toc: true
sidebar: false
webr:
    packages: 
        - datos
        - dplyr
        - tidyr
        - ggplot2
    render-df: gt-interactive
engine: knitr
---

{{< include ../_extensions/r-wasm/live/_knitr.qmd >}}




A continuación, desarrollaremos un ejercicio práctico utilizando R para ajustar un modelo lineal simple. Usaremos un conjunto de datos donde analizaremos la relación entre el **índice de masa corporal (IMC)** y **presión arterial sistólica (PAS)**.

## **Ejemplo: Relación entre IMC y Presión Arterial**

Queremos ajustar un modelo lineal que prediga la presión arterial sistólica (PAS) en función del índice de masa corporal (IMC) de los pacientes.

### **Paso 1: Cargar los datos y preparar el entorno**

```{webr}
# Cargar librerías necesarias
library(tidyverse)

# Simulamos un conjunto de datos para este ejemplo
set.seed(123)
n <- 100
datos <- tibble(
  IMC = rnorm(n, mean = 25, sd = 4),
  PAS = 120 + 0.7 * IMC + rnorm(n, sd = 10)
)

# Visualizamos las primeras filas del conjunto de datos
head(datos)
```

##### **Paso 2: Visualización preliminar**

Antes de ajustar el modelo, es útil visualizar los datos para identificar posibles patrones.

```{webr}
# Gráfico de dispersión entre IMC y PAS
ggplot(datos, aes(x = IMC, y = PAS)) +
  geom_point() +
  geom_smooth(method = "lm", col = "blue") +
  labs(title = "Relación entre IMC y Presión Arterial Sistólica",
       x = "Índice de Masa Corporal (IMC)",
       y = "Presión Arterial Sistólica (PAS)")
```

##### **Paso 3: Ajustar el modelo lineal**

Ahora ajustamos un modelo lineal simple donde la variable dependiente es la presión arterial sistólica (PAS) y la variable independiente es el índice de masa corporal (IMC).

```{webr}
# Ajustar el modelo lineal
modelo <- lm(PAS ~ IMC, data = datos)

# Resumen del modelo
summary(modelo)
```

##### **Paso 4: Interpretar los resultados del modelo**

El resumen del modelo nos proporciona información sobre:

- **Coeficiente de IMC**: Indica el cambio esperado en la presión arterial sistólica por cada unidad de incremento en el IMC.
- **Valor-p**: Nos indica si la relación entre IMC y PAS es estadísticamente significativa.
- **R-cuadrado**: Nos dice qué proporción de la variabilidad en la presión arterial sistólica es explicada por el índice de masa corporal.

##### **Paso 5: Validación del modelo**

Es importante verificar los supuestos del modelo lineal, como la normalidad de los residuos y la homocedasticidad (varianza constante de los errores).

```{webr}
# Gráfico de residuos
par(mfrow = c(2, 2))
plot(modelo)
```



### **Ejercicios Prácticos**

1. **Ejercicio 1**: Ajustar un modelo lineal entre el **peso** y la **altura** de un grupo de pacientes. Usa un conjunto de datos simulado o disponible en R.

```{webr}
   # Simular datos para peso y altura
   set.seed(456)
   datos_peso_altura <- tibble(
     Altura = rnorm(100, mean = 170, sd = 10),
     Peso = 50 + 0.5 * Altura + rnorm(100, sd = 5)
   )

   # Ajustar el modelo lineal
   modelo_peso_altura <- lm(Peso ~ Altura, data = datos_peso_altura)

   # Resumen del modelo
   summary(modelo_peso_altura)
```

   **Pregunta**: ¿Es significativa la relación entre la altura y el peso? ¿Cómo interpretarías el coeficiente de la altura en este modelo?

2. **Ejercicio 2**: Utiliza el conjunto de datos `mtcars` disponible en R para ajustar un modelo lineal que prediga el consumo de combustible (`mpg`) en función del peso del vehículo (`wt`).

```{webr}
   # Cargar datos mtcars
   data(mtcars)

   # Ajustar el modelo lineal
   modelo_mpg <- lm(mpg ~ wt, data = mtcars)

   # Resumen del modelo
   summary(modelo_mpg)
```

   **Pregunta**: ¿Cómo afecta el peso del vehículo al consumo de combustible según el modelo ajustado?



### **Conclusión**

Los modelos lineales son una herramienta poderosa y fundamental en tanto en las ciencias de la salud como en las ciencias biológicas. Al entender la simplicidad subyacente de los modelos lineales, podemos aplicar este conocimiento a una amplia variedad de pruebas estadísticas y situaciones prácticas.

